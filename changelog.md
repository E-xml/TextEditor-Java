Rewriting code from start

Adding unachieved features :
- 